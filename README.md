The Fragile Families Challenge is a data science competition where competitors attempt to predict life outcomes of disavantaged US children at the age of 15 using a plethora of data collected via interviews and surveys from the child's birth until they turned 10 [www.fragilefamilieschallenge.org/](https://www.fragilefamilieschallenge.org/).
This repository contains the code and report of my project predicting the six life outcomes of the Fragile Families Challenge and interpretting the models (Used for my applied machine learning course as part of my MSc. in Social Data Science at the University of Oxford). Due to the complexity of the task of predicting life outcomes as well as the challenge's relatively small dataset (~2100 training examples) and very messy data, it is difficult to train models that perform better than random chance. All of my best performing models performed better than baseline models and I showed that my models automatically learned features intuitively related to each of the six life outcomes. Below I include various key figures and a short summary of my work.

### Models: Hyperparameter Tuning and Performance
After cleaning the data various models were trained (see full report for the data cleaning procedure. The data was very messy, so there were a lot of data cleaning steps before any model training took place).
The models trained in my work included elastic net, tree-based models using Microsoft’s Light Gradient Boosting Machine Framework (LGBM), as well as a 1-hidden layer neural network (only 1 hidden layer to minimize overfitting).

Each of these models have various hyperparameters that needed to be tuned - for instance LGBM trees have over 10 hyperparameters. Depending on the model type, the hyperparameters were tuned using either bayesian optimization or gridsearch (depending on the parameter search space among other considerations highlighed in my paper). I used various techniques, such as early stopping, repeated/repeated stratified cross validation (for continuous and categorical outcomes, respectively) to minimize overfitting. In the end, all of my best performing models performed better than baseline models commonly used to evaluate the accuracy of models on the Fragile Families Challenge. The performance of each of my models on the held-out test set are shown below.

![alt text](https://github.com/plizeeee/Fragile-Families-Challenge/blob/main/Images/Accuracies%20on%20Test%20Set.PNG)
### Interpretting Machine Learning Models
The best performing models were interpretted using Shapley Additive Explanation (SHAP) plots to understand which features were driving the model predictions for each life outcome (and better understand the factors associated with each life outcome). SHAP feature importance plots were used to understand the global importance of each feature for model predictions – To put it differently, whenever the model makes a prediction, which features, on average, affect the model’s prediction most? The features importance plots do not give any indication on the direction of the effect (positive or negative) or each feature on model prediction. Therefore, SHAP bee swarm plots were used to visualize the individual effects of each observed feature value in the dataset on the output to better understand if the features positively or negatively affected the predicted outcome.

Example plots are shown below for the GPA lifeoutcome, where it can be seen that the feature that had the greatest effect on model predictions of the child's GPA at age 15 was the child's performance on the Woodcock Johnson test at the age of 10. It can be seen from the beeswarm plots that the model tends to predict higher GPAs at the age of 15 for students that had a higher Woodcock Johnson test score at the age of 10. Many of these features agree with common sense, so the model appears to have learned relevant features from the 5,000+ initial features. The same plots for the other six life outcomes can be found in my full report.
![alt text](https://github.com/plizeeee/Fragile-Families-Challenge/blob/main/Images/Example%20SHAP%20Features%20Importance%20Plot.PNG)
![alt text](https://github.com/plizeeee/Fragile-Families-Challenge/blob/main/Images/Example%20SHAP%20Bee%20Swarm%20Plot.PNG)